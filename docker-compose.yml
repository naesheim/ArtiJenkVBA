version: "3"

services:
    artifactory:
        build: Artifactory/
        container_name: artifactory
        ports:
            - 8081:8080
        volumes:
            - /etc/localtime:/etc/localtime

    jenkins:
        build:
            context: Jenkins/
            args:
                - JAVA_OPTS
        container_name: jenkins
        ports:
            - 8082:8080
        volumes:
            - ~/jenkins-backup/jobs:/var/jenkins_home/jobs
            - ~/jenkins-backup/userContent:/var/jenkins_home/userContent
            - /etc/localtime:/etc/localtime
            - $HOME/.ssh:/var/jenkins_home/.ssh
            - /var/lib/docker:/var/lib/docker
            - /var/run/docker.sock:/var/run/docker.sock

    prometheus:
        build: Prometheus/
        container_name: prometheus
        ports:
            - 9090:9090
    cadvisor:
        image: google/cadvisor
        volumes:
          - /var/run:/var/run:rw
          - /sys:/sys:ro
          - /var/lib/docker/:/var/lib/docker:ro
        expose:
            - 8080
        container_name: cadvisor

    grafana:
        build:
            context: Grafana/
        container_name: grafana
        ports:
            - 3000:3000
